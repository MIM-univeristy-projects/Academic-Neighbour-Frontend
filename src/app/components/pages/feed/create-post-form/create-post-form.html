<div class="create-post-container">
    <form [formGroup]="postForm" (ngSubmit)="onSubmit()" class="create-post-form">
        <div class="post-input-wrapper">
            <div class="user-avatar">
                U
            </div>

            <mat-form-field appearance="outline" subscriptSizing="dynamic">
                <mat-label>Co nowego, sąsiedzie?</mat-label>
                <textarea matInput formControlName="text" (focus)="onFocus()" [rows]="isExpanded ? 5 : 1"
                    placeholder="Podziel się swoimi myślami...">
                </textarea>
                @if (isExpanded) {
                <mat-hint align="end" [class]="characterCountColor">
                    {{ characterCount }} / 5000
                </mat-hint>
                }
                @if (text?.invalid && (text?.dirty || text?.touched)) {
                <mat-error>
                    @if (text?.errors?.['required']) {
                    Treść posta jest wymagana
                    }
                    @if (text?.errors?.['maxlength']) {
                    Post jest za długi (max 5000 znaków)
                    }
                </mat-error>
                }
            </mat-form-field>
        </div>

        @if (isExpanded) {
        <div class="form-actions">
            <button mat-stroked-button type="button" (click)="onCancel()">
                <mat-icon>close</mat-icon>
                <span>Anuluj</span>
            </button>
            <button mat-raised-button color="primary" type="submit"
                [disabled]="!postForm.valid || characterCount === 0">
                <mat-icon>send</mat-icon>
                <span>Opublikuj</span>
            </button>
        </div>
        }
    </form>
</div>